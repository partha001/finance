<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">


    <changeSet id="1_ddl_creatingTables" author="partha">
        <sql>

            CREATE SCHEMA WealthManager;

            CREATE TABLE IF NOT EXISTS WealthManager.DividendMaster(
            id serial primary key,
            symbol VARCHAR(50),
            name VARCHAR(100),
            dividendyear INTEGER,
            quarter INTEGER,
            dividendamount decimal
            );


            CREATE TABLE IF NOT EXISTS WealthManager.AssetMaster
            (
            id serial PRIMARY KEY,
            username varchar(50),
            assetType varchar(30),
            assetName VARCHAR(100),
            amount decimal,
            valuationDate DATE,
            CONSTRAINT uc_am_ExchangeSymbol UNIQUE (username,assetName,valuationDate)
            );


            CREATE TABLE IF NOT EXISTS WealthManager.StockMaster
            (
            id serial PRIMARY KEY,
            exchange VARCHAR(20),
            symbol VARCHAR(50),
            name VARCHAR(100),
            isinNumber VARCHAR(50),
            faceValue decimal,
            listingDate DATE,
            stockKey VARCHAR(50),
            CONSTRAINT uc_sm_ExchangeSymbol UNIQUE (exchange,symbol)
            );


            CREATE TABLE IF NOT EXISTS WealthManager.StockPriceMaster
            (
            id serial PRIMARY KEY,
            stockMasterId INTEGER,
            stockKey VARCHAR(50),
            price decimal,
            priceTime timestamp,
            timeZoneName VARCHAR(20)
            );


            CREATE TABLE IF NOT EXISTS WealthManager.DailyPriceMaster (
            id serial4 NOT NULL,
            stockmasterid int4 NULL,
            stockkey varchar(50) NULL,
            price numeric NULL,
            AdjClosePrice numeric NULL,
            ClosePrice numeric NULL,
            OpenPrice numeric null,
            High numeric NULL,
            Low numeric NULL,
            Volume numeric null,
            PriceDate date,
            CONSTRAINT uc_dpm_ExchangeSymbol UNIQUE (PriceDate,stockkey),
            primary key (id, PriceDate, stockkey)
            ) partition by range (PriceDate);


            CREATE TABLE WealthManager.DailyPriceMaster_2024 PARTITION OF WealthManager.DailyPriceMaster for values from ('2024-01-01') to ('2025-01-01');



        </sql>
    </changeSet>

</databaseChangeLog>